CREATE VIEW account ( AccountID long NOT NULL OPTIONS(NAMEINSOURCE 'AccountID', NATIVE_TYPE 'DECIMAL', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), CustomerId string(12) NOT NULL OPTIONS(NAMEINSOURCE 'CustomerId', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), AccountType string(10) NOT NULL OPTIONS(NAMEINSOURCE 'AccountType', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), AccountStatus string(10) NOT NULL OPTIONS(NAMEINSOURCE 'AccountStatus', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), DateOpened date OPTIONS(NAMEINSOURCE 'DateOpened', NATIVE_TYPE 'DATETIME', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), DateClosed date OPTIONS(NAMEINSOURCE 'DateClosed', NATIVE_TYPE 'DATETIME', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), CONSTRAINT PRIMARY PRIMARY KEY(AccountID), CONSTRAINT FK_Account_CustId FOREIGN KEY(CustomerId) REFERENCES customer(CustomerId)
) OPTIONS(NAMEINSOURCE 'account', UPDATABLE 'FALSE') AS SELECT convert(APAC_Customers_VBL.ACCOUNT.AccountID, long) AS AccountID, APAC_Customers_VBL.ACCOUNT.CustID AS CustomerId, APAC_Customers_VBL.ACCOUNT.AccountType, APAC_Customers_VBL.ACCOUNT.AccountStatus, convert(APAC_Customers_VBL.ACCOUNT.DATEOPENED, date) AS DateOpened, convert(APAC_Customers_VBL.ACCOUNT.DATECLOSED, date) AS DateClosed FROM APAC_Customers_VBL.account; CREATE VIEW accountholdings ( TransactionID string(15) NOT NULL OPTIONS(NAMEINSOURCE 'TransactionID', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), AccountID long NOT NULL OPTIONS(NAMEINSOURCE 'AccountID', NATIVE_TYPE 'DECIMAL', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), ProductID string(12) NOT NULL OPTIONS(NAMEINSOURCE 'ProductID', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), PurchaseDate date OPTIONS(NAMEINSOURCE 'PurchaseDate', NATIVE_TYPE 'DATETIME', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), ProductShares float NOT NULL OPTIONS(NAMEINSOURCE 'ProductShares', NATIVE_TYPE 'DECIMAL', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), CONSTRAINT PRIMARY PRIMARY KEY(TransactionID), CONSTRAINT FK_AcctHoldings_AcctID FOREIGN KEY(AccountID) REFERENCES account(AccountID)
) OPTIONS(NAMEINSOURCE 'accountholdings', UPDATABLE 'FALSE') AS SELECT APAC_Customers_VBL.ACCOUNTHOLDINGS.TransactionID, convert(APAC_Customers_VBL.ACCOUNTHOLDINGS.AccountID, long) AS AccountID, APAC_Customers_VBL.ACCOUNTHOLDINGS.ProductID, convert(APAC_Customers_VBL.ACCOUNTHOLDINGS.PURCHASEDATE, date) AS PurchaseDate, convert(APAC_Customers_VBL.ACCOUNTHOLDINGS.ProductShares, float) AS ProductShares FROM APAC_Customers_VBL.accountholdings; CREATE VIEW customer ( CustomerId string(12) NOT NULL OPTIONS(NAMEINSOURCE 'CustomerId', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), FirstName string(25) OPTIONS(NAMEINSOURCE 'FirstName', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), LastName string(25) OPTIONS(NAMEINSOURCE 'LastName', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), MiddleInitial string(15) OPTIONS(NAMEINSOURCE 'MiddleName', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), StreetAddress string(50) OPTIONS(NAMEINSOURCE 'StreetAddress', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), StreetAddress2 string(25) OPTIONS(NAMEINSOURCE 'StreetAddress2', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), City string(25) OPTIONS(NAMEINSOURCE 'City', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), StateProvince string(25) OPTIONS(NAMEINSOURCE 'StateProvince', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), PostalCode string(15) OPTIONS(NAMEINSOURCE 'PostalCode', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), Country string(15) OPTIONS(NAMEINSOURCE 'Country', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), PhoneNumber string(30) OPTIONS(NAMEINSOURCE 'PhoneNumber', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), CONSTRAINT PRIMARY PRIMARY KEY(CustomerId)
) OPTIONS(NAMEINSOURCE 'customer', UPDATABLE 'FALSE') AS SELECT APAC_Customers_VBL.CUSTOMER.CustID AS CustomerId, APAC_Customers_VBL.CUSTOMER.F_name AS FirstName, APAC_Customers_VBL.CUSTOMER.L_name AS LastName, APAC_Customers_VBL.CUSTOMER.M_name AS MiddleInitial, APAC_Customers_VBL.CUSTOMER.StreetAddress, APAC_Customers_VBL.CUSTOMER.StreetAddress2, APAC_Customers_VBL.CUSTOMER.CITY, APAC_Customers_VBL.CUSTOMER.StateProvince, APAC_Customers_VBL.CUSTOMER.POSTALCODE, APAC_Customers_VBL.CUSTOMER.COUNTRY, APAC_Customers_VBL.CUSTOMER.PhoneNumber FROM APAC_Customers_VBL.customer;