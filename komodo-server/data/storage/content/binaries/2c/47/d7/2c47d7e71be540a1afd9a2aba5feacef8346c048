CREATE VIEW account ( AccountID long NOT NULL OPTIONS(NAMEINSOURCE 'AccountID', NATIVE_TYPE 'DECIMAL', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), CustomerId string(12) NOT NULL OPTIONS(NAMEINSOURCE 'CustomerId', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), AccountType string(10) NOT NULL OPTIONS(NAMEINSOURCE 'AccountType', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), AccountStatus string(10) NOT NULL OPTIONS(NAMEINSOURCE 'AccountStatus', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), DateOpened date OPTIONS(NAMEINSOURCE 'DateOpened', NATIVE_TYPE 'DATETIME', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), DateClosed date OPTIONS(NAMEINSOURCE 'DateClosed', NATIVE_TYPE 'DATETIME', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), CONSTRAINT PRIMARY PRIMARY KEY(AccountID), CONSTRAINT FK_Account_CustId FOREIGN KEY(CustomerId) REFERENCES customer(CustomerId)
) OPTIONS(NAMEINSOURCE 'account', UPDATABLE 'FALSE') AS SELECT convert(US_Customers_VBL.account.AccountID, long) AS AccountID, US_Customers_VBL.account.SSN AS CustomerId, US_Customers_VBL.account.AccountType, US_Customers_VBL.account.AccountStatus, convert(US_Customers_VBL.account.DateOpened, date) AS DateOpened, convert(US_Customers_VBL.account.DateClosed, date) AS DateClosed FROM US_Customers_VBL.account; CREATE VIEW accountholdings ( TransactionID string(15) NOT NULL OPTIONS(NAMEINSOURCE 'TransactionID', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), AccountID long NOT NULL OPTIONS(NAMEINSOURCE 'AccountID', NATIVE_TYPE 'DECIMAL', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), ProductID string(12) NOT NULL OPTIONS(NAMEINSOURCE 'ProductID', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), PurchaseDate date OPTIONS(NAMEINSOURCE 'PurchaseDate', NATIVE_TYPE 'DATETIME', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), ProductShares float NOT NULL OPTIONS(NAMEINSOURCE 'ProductShares', NATIVE_TYPE 'DECIMAL', CASE_SENSITIVE 'FALSE', UPDATABLE 'FALSE', FIXED_LENGTH 'TRUE', SEARCHABLE 'ALL_EXCEPT_LIKE'), CONSTRAINT PRIMARY PRIMARY KEY(TransactionID), CONSTRAINT FK_AcctHoldings_AcctID FOREIGN KEY(AccountID) REFERENCES account(AccountID)
) OPTIONS(NAMEINSOURCE 'accountholdings', UPDATABLE 'FALSE') AS SELECT US_Customers_VBL.accountholdings.TransactionID, convert(US_Customers_VBL.accountholdings.AccountID, long) AS AccountID, US_Customers_VBL.accountholdings.ProductID, convert(US_Customers_VBL.accountholdings.PurchaseDate, date) AS PurchaseDate, convert(US_Customers_VBL.accountholdings.ProductShares, float) AS ProductShares FROM US_Customers_VBL.accountholdings; CREATE VIEW customer ( CustomerId string(12) NOT NULL OPTIONS(NAMEINSOURCE 'CustomerId', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), FirstName string(25) OPTIONS(NAMEINSOURCE 'FirstName', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), LastName string(25) OPTIONS(NAMEINSOURCE 'LastName', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), MiddleInitial string(15) OPTIONS(NAMEINSOURCE 'MiddleName', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), StreetAddress string(50) OPTIONS(NAMEINSOURCE 'StreetAddress', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), StreetAddress2 string(25) OPTIONS(NAMEINSOURCE 'StreetAddress2', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), City string(25) OPTIONS(NAMEINSOURCE 'City', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), StateProvince string(25) OPTIONS(NAMEINSOURCE 'StateProvince', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), PostalCode string(15) OPTIONS(NAMEINSOURCE 'PostalCode', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), Country string(15) OPTIONS(NAMEINSOURCE 'Country', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), PhoneNumber string(30) OPTIONS(NAMEINSOURCE 'PhoneNumber', NATIVE_TYPE 'VARCHAR', UPDATABLE 'FALSE'), CONSTRAINT PRIMARY PRIMARY KEY(CustomerId)
) OPTIONS(NAMEINSOURCE 'customer', UPDATABLE 'FALSE') AS SELECT SSN AS CustomerId, FirstName, LastName, MiddleInitial, StreetAddress1 AS StreetAddress, AptNumber AS StreetAddress2, City, State AS StateProvince, Zipcode AS PostalCode, 'USA' AS Country, Phone AS PhoneNumber FROM US_Customers_VBL.customer;